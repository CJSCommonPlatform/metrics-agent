language: java
jdk:
  - oraclejdk8
cache:
  directories:
    - "$HOME/.m2"
before_install:
  - git clone https://github.com/CJSCommonPlatform/travis-settings.git target/travis-settings
install:
  - cp -f $JAVA_HOME/jre/lib/security/cacerts target/travis-settings/cacerts
  - chmod u+w target/travis-settings/cacerts
  - $JAVA_HOME/jre/bin/keytool -import -v -noprompt -storepass changeit -storetype jks -trustcacerts -alias IndigoBlueRoot -file target/travis-settings/ROOT-CA.crt -keystore target/travis-settings/cacerts
script: mvn -Djavax.net.ssl.trustStore=$PWD/target/travis-settings/cacerts -B -C -V -U --settings target/travis-settings/settings.xml verify coveralls:report
after_success:
  - '[[ $TRAVIS_BRANCH == "master" && $TRAVIS_PULL_REQUEST == "false" && $TRAVIS_TAG != release-* ]] && mvn -Djavax.net.ssl.trustStore=$PWD/target/travis-settings/cacerts -DskipTests=true -B -C -V --errors deploy --settings target/travis-settings/settings.xml'
  - '[[ $TRAVIS_TAG == release-* ]] && mvn -Prelease -Djavax.net.ssl.trustStore=$PWD/target/travis-settings/cacerts -DskipTests=true -B -C -V --errors deploy --settings target/travis-settings/settings.xml'
notifications:
  slack:
    secure: e/bNxPiRBvdli+B6TENET7tK7edh3Bakiknqy5MAL4B/b+tEt4MoguQ1lslKMA+fUkKPgvm1Bu08yUvB3bc5K3QdWDRA86aovYXWiqJy8Simq7EoF6fBLbZzlSrxOj8NfVC7pniLGhuG7roQb6av9sZj69KIbpwqPejFB2kilx8zlVb7OhzjqV0BNcQimDBa7UrzvyhwuM7+SYC6LFqZz2s59z8c7cY9EsPZ56s+Fc9uV3SduPT/Ps0wFd8MuG5gXqrloyc1SFlJjL75sITVs690GZl/lOCqfpVEGwvoL7To/e/uqV0hpkf8Oo7FhrBibD4wpeewiOtCaIfY6yEW//MQ3FLz0gE8jGb7ZkNhKYyHIdXiTRnb2Dg3R83JellbAdhXO58+Cj4IKQJ7PXsvTALiOwGuzLxaFZM0JC0Q1EsUbrqJtXPnJMhrEnCY9vna9fwCwjSriUzCxevxbXTw7RDmzNm5hW2wi9vGeJbMC3ca/iTnTBIB7knAIR6OzBnAlpq2iaDr9N/DfdnPaz5sQUz9qPv09DVJ4Ppiaap6ZlRYDO3apNpKg2ljos4xiFqhS8+IPD9rUb0wonMwJb5Iygv0/YNFVnramjrI/MS0eC2b7GgaZZh2zLIEsMYPL230rqBSff9wwDBnAgRTQ/b4G1wPepL/Hp03pIwOEUSOAOs=
env:
  global:
  - secure: J7LOeaStYA4xDLFOrlGpbVsj0sZpdOan9LTpScyf//C40w5FMlevMiq+NiYJf7IZrwTV8ZEigNvrBQSJlfUd/chr59ezgm0QhKien3lmGu1RV4itEcHI5uRq2K8NsDdtuYmKWOrTgfuFoQPW91Nzt9w9a5nERhSHgZSJAaKhKzcpR6bpt4ahPQ6KNjPy+27hzw7xW5p1CKjhatGcKZD2aZIwiXLKWHH/XSYZmN2e/74a6s3AuqWdv0UJLfQ7dVZo2ea8K6o+jleUyxyRzJWbnuOqBkgRTy02v9Gim20qpVstCqzAX3Ul9BIs67QoEkgASR+wYj6jeC467dSqMGKJQF097hZ4Nfls/C7pJgTdri2l8jbJ+RVazvuoftt+iCH11LI1dU5D4AVmMSufM3XDZKwSTaxKd7JgtTh89lnFa0dF0WBT29BUtte0yoL1fPmpeCItony0+GgqUcTrvxFfVP3B46UGyA4FSqkTORqzXKW+s4GF/XkTnNYvmFubOcTMy0vFw6gma/sfQH1OStJKL+bNFUPUjezBGG2hwPEzssLGDvazcvVVSEtLlBZe6Bkv0XM5cblpkZoTOyzR1M26LyEemQ19IDQj71vOOOI3GXXLrpnejW32aestkSnvAcNRDezPlHgFZ0vT240Hs5YvHXgOivyUN4lK4Hrl8dbdrmc=
  - secure: MpgQbjcVs1ndXel0k1/QWBVDJon77Tk7shQCA6IoA8+exDqwdoCWMcQ0+UyBjd+pG8jLo3Li+j6gyTR5kFd4GrwVs0zkQZSX9/EW+wpEZaBJtlN164MysI9QETu8sqA/Q+Qr8Xw4u5egny2/1w2f86zUMLsjD+oKpXE521RdlULlBVzrfyC3sXAJVybueTH+1J+YV97ECGQhuXvFW5i5/1kogm2+w0RJqdEcYY3Jgt8yDzJu08uPU8sp0pR51XAigNqPODFbbf75Y/7MKWo0o4xHy8NYGJC6+dpLMwJ8/BMHeIMLvTvZYsQyuD0oG/DVxE9fKeC/XAZ0o3X6uxbGlGyEVUHBp3iezYvObfXre99EsgQCHZ0IK/hIiDDSLi2YVKuzG1NUyZQaX3f0wy6RXinh6eKQFrkT++E3L0UEtSd9JZBUIGZl/8GLlcGLVxsmLg5azI5/kjfGssTzNgALP1Q2ykKFmARFauwonuw93ICagpSMrGhednCCYq7TFMnujM3nSWgsoeJ+nBQvkFykufEL9tj7zAgG4KbKIxVSGb3sHxDMyo9w8JB2YHdvlpwFyhWtb27jKcaVEhfqjxh1ti0rQdBvY4FIoclZ+ji4aWAjB2r8meKe5q/B/hWwZpdRaXgMWQVHMBhw9Ifp4QfD1f3RvHBdzaWQlLMCzjiuyfA=
